<!doctype html><html><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=generator content="Hugo 0.111.2"><link rel=stylesheet href=http://example.org/scss/style.css><link rel=stylesheet href=http://example.org/style.css><body><header class="top-0 sticky"><div class="backdrop-blur transition-colors duration-500 border-slate-50/[0.06] bg-black/65"><div class=inline-block><a href=/menu/><i class='fa fa-heart'></i>
<span>404</span></a></div><div class=inline-block><a href=/about/><i class='fa fa-heart'></i>
<span>关于</span></a></div></div></header><div id=content><div class="w-full max-w-8xl"><div class=flex><aside class="fixed top-10 z-40 lg:w-40 lg:block hidden"><nav id=TableOfContents><ul><li><a href=#安装-sortablejs>安装 sortablejs</a></li><li><a href=#在-vue-中引入-sortablejs>在 Vue 中引入 sortablejs</a></li><li><a href=#为拖拽的-table-配置-ref-和-row-key>为拖拽的 table 配置 ref 和 row-key</a></li><li><a href=#创建拖拽表格实例>创建拖拽表格实例</a></li><li><a href=#在-onmounted-方法中调用>在 onMounted 方法中调用</a></li></ul></nav></aside><article class="prose prose-zinc prose-lg mx-auto">模版: default single<h1 id=sortablejseltable-拖拽>Sortablejs+ElTable 拖拽</h1><p>element plus + sortablejs 实现表格拖拽功能</p><h2 id=安装-sortablejs>安装 sortablejs</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ npm i sortablejs --save
</span></span></code></pre></div><h2 id=在-vue-中引入-sortablejs>在 Vue 中引入 sortablejs</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Sortable</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;sortablejs&#34;</span>
</span></span></code></pre></div><h2 id=为拖拽的-table-配置-ref-和-row-key>为拖拽的 table 配置 ref 和 row-key</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// row-key 设置为 table 数据源中能标识每一行唯一性的字段
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>el</span><span style=color:#f92672>-</span><span style=color:#a6e22e>table</span> <span style=color:#f92672>:</span><span style=color:#a6e22e>data</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;datas&#34;</span> <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dragTable&#34;</span> <span style=color:#a6e22e>row</span><span style=color:#f92672>-</span><span style=color:#a6e22e>key</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;rowId&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/el-table&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dragTable</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>();
</span></span></code></pre></div><h2 id=创建拖拽表格实例>创建拖拽表格实例</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>createDragTable</span> <span style=color:#f92672>=</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>//引用的元素 通过 css 选择器 查到 table 元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>table</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dragTable</span>.<span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>$el</span>.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;.el-table__body-wrapper tbody&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>table</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>//创建表格拖拽
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>dTable</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Sortable</span>.<span style=color:#a6e22e>create</span>(<span style=color:#a6e22e>table</span>, {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>animation</span><span style=color:#f92672>:</span><span style=color:#ae81ff>150</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onStart</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#75715e>//开始拖拽
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onMove</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>val</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>             * 拖拽中
</span></span></span><span style=display:flex><span><span style=color:#75715e>             * val.dragged.rowIndex 正在拖拽行的下标
</span></span></span><span style=display:flex><span><span style=color:#75715e>             * val.related.rowIndex 预计拖拽后行的下标
</span></span></span><span style=display:flex><span><span style=color:#75715e>             */</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//第一行不可拖到其他行，其他行也不可拖到第一行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>val</span>.<span style=color:#a6e22e>dragged</span>.<span style=color:#a6e22e>rowIndex</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>val</span>.<span style=color:#a6e22e>related</span>.<span style=color:#a6e22e>rowIndex</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onEnd</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>el</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>debug</span>(<span style=color:#e6db74>&#39;结束拖拽&#39;</span>,<span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>showIndex</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 更新 table 的数据源
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>datas</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>newIndex</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>datas</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>oldIndex</span>, <span style=color:#ae81ff>1</span>)[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=在-onmounted-方法中调用>在 onMounted 方法中调用</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>onMounted</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>createDragTable</span>();
</span></span><span style=display:flex><span>});
</span></span></code></pre></div></article></div></div></div></body></html>